# import name value
#:import asynckivy asynckivy
#:import sys sys


MDScreenManager:
    md_bg_color: self.theme_cls.backgroundColor

    MDScreen:
        name: 'start_screen'

        MDFloatLayout:
            Label:
                id: game_logo
                text: 'Digital Pong'
                font_size: 72
                color: 'FF8700'
                outline_color: 'A65800'
                outline_width: 2
                pos: (0, (root.size[1] // 2) - self.texture_size[1])

            Label:
                id: username_label
                text: ''
                font_size: 24
                color: 'FF8700'
                outline_color: 'A65800'
                outline_width: 2
                pos: (root.size[0]/3, (root.size[1] // 2) - self.texture_size[1] - 30)

            MDIconButton:
                id: quit_the_game
                icon: 'exit-to-app'
                pos: (50, root.size[1] - self.texture_size[1] - 50)
                on_release: sys.exit(0)
                style: 'outlined'

            MDIconButton:
                id: change_theme
                icon: 'theme-light-dark'
                pos: (root.size[0] - self.texture_size[0] - 50, root.size[1] - self.texture_size[1] - 50)
                on_release: app.theme_cls.switch_theme()
                style: 'outlined'

            MDIconButton:
                id: change_theme_color
                icon: 'format-color-fill'
                pos: (root.size[0] - self.texture_size[0] - 50, root.size[1] - change_theme.texture_size[1] - self.texture_size[1] - 100)
                on_release: app.change_theme_color()
                style: 'outlined'

            MDButton:
                id: choice_room
                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                style: "outlined"
                on_release: app.ss_to_rc()
                MDButtonText:
                    text: 'choose a room'

            MDButton:
                id: enter_data
                pos: (100, 100)
                style: "outlined"
                on_release: app.root.current = 'data_enter'
                MDButtonText:
                    text: 'enter data'

    MDScreen:
        name: 'data_enter'

        MDTextField:
            id: username_field
            mode: "outlined"
            size_hint: (0.5, None)
            pos_hint: {'center_x': 0.5, 'center_y': 0.7}

            #on_touch_down: if self.collide_point(*args[1].pos): app.action()

            MDTextFieldHintText:
                text: 'username'

        MDTextField:
            id: password_field
            mode: "outlined"
            size_hint: (0.5, None)
            pos_hint: {'center_x': 0.5, 'center_y': 0.4}

            #on_touch_down: if self.collide_point(*args[1].pos): app.action()

            MDTextFieldHintText:
                text: 'password'

        MDButton:
            id: registrating
            pos_hint: {'center_x': 0.25, 'center_y': 0.2}
            style: "outlined"
            on_release: app.load_data('registration')
            MDButtonText:
                text: 'registration'

        MDButton:
            id: loging
            pos_hint: {'center_x': 0.50, 'center_y': 0.2}
            style: "outlined"
            on_release: app.load_data('login')
            MDButtonText:
                text: 'login'

        MDButton:
            id: loging
            pos_hint: {'center_x': 0.75, 'center_y': 0.2}
            style: "outlined"
            on_release: app.load_data('exit')
            MDButtonText:
                text: 'exit'

        MDIconButton:
            id: back_to_start_menu
            icon: 'keyboard-backspace'
            pos: (50, root.size[1] - self.texture_size[1] - 50)
            on_release: app.root.current = 'start_screen'
            style: 'outlined'



    MDScreen:
        name: 'room_choice'

        MDFloatLayout:

            MDIconButton:
                id: back_to_start_menu
                icon: 'keyboard-backspace'
                pos: (50, root.size[1] - self.texture_size[1] - 50)
                on_release: app.rc_to_ss()
                style: 'outlined'

            SearchRoomField:
                id: room_field
                mode: "outlined"
                #api: app.API
                room_id_length: 10
                size_hint: (None, None)
                size: (root.size[0] - (150 + 300), 40)
                pos: (back_to_start_menu.size[0] + create_room.size[0] + 110, root.size[1] - 50 - self.size[1] + (self.size[1] // 2 - back_to_start_menu.size[1] // 2))

                #on_touch_down: if self.collide_point(*args[1].pos): app.action()

                MDTextFieldLeadingIcon:
                    icon: "identifier"

                MDTextFieldHintText:
                    text: 'Room'

                MDTextFieldMaxLengthText:
                    max_text_length: 10

                MDTextFieldHelperText:
                    text: "id не найден"
                    mode: "on_error"

            MDButton:
                style: 'outlined'
                pos: (back_to_start_menu.size[0] + create_room.size[0] + room_field.size[0] + 140, root.size[1] - self.size[1] - 50)
                #on_touch_down: if self.collide_point(*args[1].pos): app.start_search_rooms()
                #on_release: app.choose_room()

                MDButtonIcon:
                    icon: 'google-classroom'

                MDButtonText:
                    text: 'choose...'


            MDButton:
                id: create_room
                style: 'outlined'
                pos: (back_to_start_menu.size[0] + 80, root.size[1] - self.size[1] - 50)
                on_release: app.test_on_start()
                MDButtonIcon:
                    icon: 'plus-box'

                MDButtonText:
                    text: 'create'


            ItemBox:
                widgets_limit: 2
                window_size: root.size
                id: player_box
                #size_hint_y: 0.3
                size_hint_x: .9
                spacing: 15
                #on_touch_down: if self.collide_point(*args[1].pos): app.test_action(self.size)

            MDButton:
                id: start_game
                style: 'outlined'
                pos_hint: {'center_x': 0.5}
                pos: (0, 100)
                on_release: app.can_enter()

                MDButtonText:
                    text: 'start_game'
    MDScreen:
        name: 'game_field'
        id: battle_field

        BattleField:
            id: bf

            MDIconButton:
                widget_id: 'back_to_start_menu'
                icon: 'keyboard-backspace'
                pos: (50, root.size[1] - self.texture_size[1] - 50)
                style: 'outlined'
                on_release: app.gf_to_rc()

    MDScreen:
        name: 'create_room'
        MDFloatLayout:














